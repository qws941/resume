{
  "name": "Weekly Job Application Report",
  "nodes": [
    {
      "id": "schedule-trigger",
      "name": "Weekly Schedule (Monday 9AM)",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [240, 300],
      "parameters": {
        "rule": {
          "interval": [{"field": "cronExpression", "expression": "0 9 * * 1"}]
        }
      }
    },
    {
      "id": "fetch-report",
      "name": "Fetch Weekly Report",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [460, 300],
      "parameters": {
        "method": "GET",
        "url": "http://localhost:3000/api/report/weekly",
        "options": {}
      }
    },
    {
      "id": "format-message",
      "name": "Format Slack Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300],
      "parameters": {
        "jsCode": "const report = $input.first().json;\nconst emoji = {applied:'ðŸ“¤',interview:'ðŸŽ¯',offer:'ðŸŽ‰',rejected:'âŒ'};\nlet status = Object.entries(report.byStatus||{}).map(([s,c])=>`${emoji[s]||'â€¢'} ${s}: ${c}`).join('\\n');\nreturn {blocks:[{type:'header',text:{type:'plain_text',text:'ðŸ“Š Weekly Report'}},{type:'section',fields:[{type:'mrkdwn',text:`*Total*\\n${report.total||0}`},{type:'mrkdwn',text:`*This Week*\\n${report.thisWeek||0}`}]},{type:'section',text:{type:'mrkdwn',text:`*Status*\\n${status||'None'}`}}]};"
      }
    },
    {
      "id": "send-slack",
      "name": "Send to Slack",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.1,
      "position": [900, 300],
      "parameters": {
        "authentication": "oAuth2",
        "channel": "#job-applications",
        "blocksUi": "={{ JSON.stringify($json.blocks) }}",
        "otherOptions": {}
      },
      "credentials": {
        "slackOAuth2Api": {"id": "slack-oauth", "name": "Slack OAuth2"}
      }
    }
  ],
  "connections": {
    "schedule-trigger": {"main": [[{"node": "fetch-report", "type": "main", "index": 0}]]},
    "fetch-report": {"main": [[{"node": "format-message", "type": "main", "index": 0}]]},
    "format-message": {"main": [[{"node": "send-slack", "type": "main", "index": 0}]]}
  },
  "settings": {"executionOrder": "v1"},
  "tags": ["automation", "reporting", "slack"],
  "triggerCount": 1
}
